<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>menuWindow</title>
    <meta name="author" content="loosewheel">
    <style>a:link {text-decoration:none;}</style>
  </head>
  <body style="font-family: sans-serif;">
    <h1 style="background-color: rgb(128, 128, 255); padding: 8pt;"><a
        name="top"></a>win.menuWindow - WIN</h1>
    Class <b>menuWindow</b><br>
    Inherits from <a moz-do-not-send="true" href="listWindow.html">listWindow</a>.<br>
    <br>
    The menuWindow class provides a vertical list of selectable strings,
    initially empty and invisible. Menu items must be added to the menu
    after creation with <a moz-do-not-send="true"
      href="#menuWindow:add_string">menuWindow:add_string</a>, and then
    call <a moz-do-not-send="true" href="#menuWindow:track">menuWindow:track</a>
    which displays it in the parent window and operates the menu. The
    menu object automatically destroys itself when the menu operation
    completes. Its colors are initialized from the theme but may be
    customized after creation. If an item is selected by the user a <a
      moz-do-not-send="true" href="events.html#menu_cmd">menu_cmd</a>
    event is sent to the parent with a first parameter of the menu
    item's id. Pressing Ctrl will cancel a menu without action.<br>
    <br>
    Typical usage, only local object required:<br>
    <pre><font color="#cc0000">-- command ids</font><br><font color="#000066">local</font> IDM_ONE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 1001<br><font color="#000066">local</font> IDM_TWO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 1002<br><font color="#000066">local</font> IDM_THREE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 1003<br><font color="#000066">local</font> IDM_QUITAPP&nbsp;&nbsp;&nbsp; = 1004<br><br><br><font color="#000066">function</font> appFrame:on_event (event, p1, p2, p3, p4, p5, ...)<br>&nbsp;&nbsp; <font color="#cc0000">-- handle events and return true</font><br>&nbsp;&nbsp; <font color="#000066">if</font> event == <font color="#ffcc33">"menu_cmd"</font> <font color="#000066">then</font><br> &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="#000066">return</font> self:on_command (p1)<br>&nbsp;&nbsp; <font color="#000066">end</font><br><br>&nbsp;&nbsp; <font color="#000066">return</font> <font color="#000066">false</font><br><font color="#000066">end</font><br><br><br><font color="#cc0000">-- method to create and display menu</font><br><font color="#000066">function</font> appFrame:on_menu ()<br>&nbsp;&nbsp;&nbsp; <font color="#000066">local</font> menu = win.menuWindow:new (self)<br><br>&nbsp;&nbsp;&nbsp; menu:add_string (<font color="#ffcc33">"One&nbsp;&nbsp; Ctrl+1"</font>,&nbsp;&nbsp; IDM_ONE)<br>&nbsp;&nbsp;&nbsp; menu:add_string (<font color="#ffcc33">"Two&nbsp;&nbsp; Ctrl+2"</font>,&nbsp;&nbsp; IDM_TWO)<br>&nbsp;&nbsp;&nbsp; menu:add_string (<font color="#ffcc33">"Three Ctrl+3"</font>,&nbsp;&nbsp; IDM_THREE)<br>&nbsp;&nbsp;&nbsp; menu:add_string (<font color="#ffcc33">"------------"</font>)<br>&nbsp;&nbsp;&nbsp; menu:add_string (<font color="#ffcc33">"Quit App"</font>,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IDM_QUITAPP)<br><br>&nbsp;&nbsp;&nbsp; menu:track (0, 1)<br><font color="#000066">end</font><br><br><br><font color="#cc0000">-- command handler</font><br><font color="#000066">function</font> appFrame:on_command (cmd_id)<br>&nbsp;&nbsp;&nbsp; <font color="#000066">if</font> cmd_id == IDM_ONE <font color="#000066">then</font><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="#cc0000">-- do something</font><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="#000066">return</font> <font color="#000066">true</font><br>&nbsp;&nbsp;&nbsp; <font color="#000066">end</font><br><br>&nbsp;&nbsp;&nbsp; <font color="#000066">if</font> cmd_id == IDM_TWO <font color="#000066">then</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#cc0000">-- do something</font><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="#000066">return</font> <font color="#000066">true</font><br>&nbsp;&nbsp;&nbsp; <font color="#000066">end</font><br><br>&nbsp;&nbsp;&nbsp; <font color="#000066">if</font> cmd_id == IDM_THREE <font color="#000066">then</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#cc0000">-- do something</font><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="#000066">return</font> <font color="#000066">true</font><br>&nbsp;&nbsp;&nbsp; <font color="#000066">end</font><br><br>&nbsp;&nbsp;&nbsp; <font color="#000066">if</font> cmd_id == IDM_QUITAPP <font color="#000066">then</font><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; self:quit_app ()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="#000066">return</font> <font color="#000066">true</font><br>&nbsp;&nbsp;&nbsp; <font color="#000066">end</font><br><br>&nbsp;&nbsp;&nbsp; <font color="#000066">return</font> <font color="#000066">false</font><br><font color="#000066">end</font></pre>
    <br>
    <br>
    <b>Properties</b><br>
    <br>
    none&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>
    <br>
    <b>Methods</b><br>
    <ul id="mozToc">
      <!--mozToc h3 1-->
      <li><a href="#mozTocId860359">menuWindow:add_string</a></li>
      <li><a href="#mozTocId184221">menuWindow:constructor</a></li>
      <li><a href="#mozTocId396657">menuWindow:next_valid_item</a></li>
      <li><a href="#mozTocId523484">menuWindow:on_blur</a></li>
      <li><a href="#mozTocId768277">menuWindow:on_key</a></li>
      <li><a href="#mozTocId178775">menuWindow:on_left_click</a></li>
      <li><a href="#mozTocId840759">menuWindow:on_touch</a></li>
      <li><a href="#mozTocId903750">menuWindow:prior_valid_item</a></li>
      <li><a href="#mozTocId493795">menuWindow:set_cur_sel</a></li>
      <li><a href="#mozTocId516686">menuWindow:track</a></li>
    </ul>
    <br>
    See also <a moz-do-not-send="true" href="api_reference.html">API
      Reference</a>, <a moz-do-not-send="true" href="index.html">WIN</a>.<br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId860359" class="mozTocH3"></a><a
        name="menuWindow:add_string"></a>win.menuWindow:add_string</h3>
    <i>menuWindow:add_string (str, item_id, index)</i><br>
    <br>
    Inserts a string into the menu at the given index.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">str </td>
          <td valign="top">string </td>
          <td valign="top">The string to display in the menu. </td>
        </tr>
        <tr>
          <td valign="top">item_id </td>
          <td valign="top">number/nil </td>
          <td valign="top">Unique value for the menu command. If zero or
            nil the item is treated as inactive (useful for separators).
          </td>
        </tr>
        <tr>
          <td valign="top">index</td>
          <td valign="top">number</td>
          <td valign="top">1 based index to insert the item. If nil or
            out of range the item is added to the end of the list.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">none </td>
          <td valign="top"><br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    The item_id should be a unique number value identifying this menu
    item's command. This value is passed as the first parameter to the
    parent in the <a moz-do-not-send="true" href="events.html#menu_cmd">menu_cmd</a>
    event to indicated the user's response.<br>
    <br>
    Strings must be added to the menu after creation but before calling
    <a moz-do-not-send="true" href="#menuWindow:track">menuWindow:track</a>.<br>
    <br>
    Invalidation is handled.<br>
    <br>
    See <a moz-do-not-send="true"
      href="listWindow.html#listWindow:add_string">listWindow:add_string</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId184221" class="mozTocH3"></a><a
        name="menuWindow:constructor"></a>win.menuWindow:constructor</h3>
    <i> menu menuWindow:constructor (parent)</i><br>
    <br>
    Constructs and returns the instantiated menu window.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">parent </td>
          <td valign="top">window </td>
          <td valign="top">Parent window, typically a frame. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">menu </td>
          <td valign="top">menuWindow </td>
          <td valign="top">The instantiated menu window. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    The menu window is initially empty and invisible. Items must be
    added to the menu after creation with <a moz-do-not-send="true"
      href="#menuWindow:add_string">menuWindow:add_string</a>, and then
    call <a moz-do-not-send="true" href="#menuWindow:track">menuWindow:track</a>
    which displays it in the parent window and operates the menu.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId396657" class="mozTocH3"></a><a
        name="menuWindow:next_valid_item"></a>win.menuWindow:next_valid_item</h3>
    <i> index menuWindow:next_valid_item (from)</i><br>
    <br>
    Returns the index of the next active item (non-zero item_id)&nbsp;
    after from. If none from is returned.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">from </td>
          <td valign="top">number </td>
          <td valign="top">The index of the item to search from. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">index </td>
          <td valign="top">number </td>
          <td valign="top">The next active item after from, or from if
            none. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true" href="#menuWindow:prior_valid_item">menuWindow:prior_valid_item</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId523484" class="mozTocH3"></a><a
        name="menuWindow:on_blur"></a>win.menuWindow:on_blur</h3>
    <i> result menuWindow:on_blur (focused)</i><br>
    <br>
    Destroys this menu window.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">focused </td>
          <td valign="top">window </td>
          <td valign="top">The window gaining focus, it may be nil. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">boolean </td>
          <td valign="top">Always true. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks<br>
    </b> See <a moz-do-not-send="true"
      href="window.html#window:on_blur">window:on_blur</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true"
href="menuWindow.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId768277" class="mozTocH3"></a><a
        name="menuWindow:on_key"></a>win.menuWindow:on_key</h3>
    <i> result menuWindow:on_key (key, ctrl, alt, shift)</i><br>
    <br>
    Handles key events; up, down, home, end, ctrl (destroys the menu
    window), and destroys this menu window and sends a <a
      moz-do-not-send="true" href="events.html#menu_cmd">menu_cmd</a>
    event to the parent window on enter with a first parameter of the
    selected menu item_id.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">key </td>
          <td valign="top">number </td>
          <td valign="top">Key code. </td>
        </tr>
        <tr>
          <td valign="top">ctrl </td>
          <td valign="top">boolean </td>
          <td valign="top">True if control key is depressed. </td>
        </tr>
        <tr>
          <td valign="top">alt</td>
          <td valign="top">boolean</td>
          <td valign="top">True if alternate key is depressed.</td>
        </tr>
        <tr>
          <td valign="top">shift</td>
          <td valign="top">boolean</td>
          <td valign="top">True if shift key is depressed.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">boolean </td>
          <td valign="top">True if key was handled, false if not. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true" href="window.html#window:on_key">window:on_key</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true"
href="menuWindow.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId178775" class="mozTocH3"></a><a
        name="menuWindow:on_left_click"></a>win.menuWindow:on_left_click</h3>
    <i> result menuWindow:on_left_click (x, y, count)</i><br>
    <br>
    Calls base window implementation, sets the selected item at the
    click point and sends a <a moz-do-not-send="true"
      href="events.html#menu_cmd">menu_cmd</a> event to the parent
    window if on an item with a first parameter of the menu item_id, and
    destroys this menu window.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">x </td>
          <td valign="top">number </td>
          <td valign="top">Window relative x position. </td>
        </tr>
        <tr>
          <td valign="top">y </td>
          <td valign="top">number </td>
          <td valign="top">Window relative y position. </td>
        </tr>
        <tr>
          <td valign="top">count</td>
          <td valign="top">number</td>
          <td valign="top">The number of times this same position was
            repeatedly clicked, with each successive click within the <i>double_click_time</i>.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">boolean </td>
          <td valign="top">Always true. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true"
      href="window.html#window:on_left_click">window:on_left_click</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true"
href="menuWindow.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId840759" class="mozTocH3"></a><a
        name="menuWindow:on_touch"></a>win.menuWindow:on_touch</h3>
    <i> result menuWindow:on_touch (x, y)</i><br>
    <br>
    Calls base window implementation, sets the selected item at the
    touch point and sends a <a moz-do-not-send="true"
      href="events.html#menu_cmd">menu_cmd</a> event to the parent
    window if on an item with a first parameter of the menu item_id, and
    destroys this menu window.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">x </td>
          <td valign="top">number </td>
          <td valign="top">Window relative x position. </td>
        </tr>
        <tr>
          <td valign="top">y </td>
          <td valign="top">number </td>
          <td valign="top">Window relative y position. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">boolean </td>
          <td valign="top">Always true. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true" href="window.html#window:on_touch">window:on_touch</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true"
href="menuWindow.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId903750" class="mozTocH3"></a><a
        name="menuWindow:prior_valid_item"></a>win.menuWindow:prior_valid_item</h3>
    <i> index menuWindow:prior_valid_item (from)</i><br>
    <br>
    Returns the index of the next active item (non-zero item_id)&nbsp;
    before from. If none from is returned.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">from </td>
          <td valign="top">number </td>
          <td valign="top">The index of the item to search from. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">index </td>
          <td valign="top">number </td>
          <td valign="top">The next active item before from, or from if
            none. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true" href="#menuWindow:next_valid_item">menuWindow:next_valid_item</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true"
href="menuWindow.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId493795" class="mozTocH3"></a><a
        name="menuWindow:set_cur_sel"></a>win.menuWindow:set_cur_sel</h3>
    <i> changed menuWindow:set_cur_sel (index, make_visible)</i><br>
    <br>
    Sets the currently selected item in the menu to the index given (1
    based).<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">index </td>
          <td valign="top">number </td>
          <td valign="top">1 based index of the item to select. Zero or
            nil for no selection. </td>
        </tr>
        <tr>
          <td valign="top">make_visible </td>
          <td valign="top">boolean </td>
          <td valign="top">If true or nil scrolling is adjusted to bring
            the selected item into view if needed. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">changed </td>
          <td valign="top">boolean </td>
          <td valign="top">True if the current selection changed, false
            if not. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    If index is greater than the number of items in the menu the last
    one is selected.<br>
    <br>
    Invalidation is handled.<br>
    <br>
    <br>
    <a moz-do-not-send="true"
href="menuWindow.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId516686" class="mozTocH3"></a><a
        name="menuWindow:track"></a>win.menuWindow:track</h3>
    <i> menuWindow:track (x, y)</i><br>
    <br>
    Dimensions the menu window to accommodate all the string entries and
    displays it in the parent window at x, y, adjusted if required. The
    menu is assured at the top of the parent's child z order, and has
    mouse capture.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">x </td>
          <td valign="top">number </td>
          <td valign="top">Parent relative x position. </td>
        </tr>
        <tr>
          <td valign="top">y </td>
          <td valign="top">number </td>
          <td valign="top">Parent relative y position. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">none </td>
          <td valign="top"><br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    <br>
    <br>
    <a moz-do-not-send="true"
href="menuWindow.html#top">top</a><br>
    <br>
    <br>
    See also <a moz-do-not-send="true" href="api_reference.html">API
      Reference</a>, <a moz-do-not-send="true" href="index.html">WIN</a>.<br>
    <br>
    <br>
  </body>
</html>
