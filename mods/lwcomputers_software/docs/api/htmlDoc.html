<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>htmlDoc</title>
    <meta name="author" content="loosewheel">
    <style>a:link {text-decoration:none;}</style>
  </head>
  <body style="font-family: sans-serif;">
    <h1 style="background-color: rgb(128, 128, 255); padding: 8pt;"><a
        name="top"></a>html.htmlDoc - WIN</h1>
    Class <b>htmlDoc</b><br>
    Inherits from <a moz-do-not-send="true" href="__classBase.html">__classBase</a>.<br>
    <br>
    The htmlDoc class provides an object representation of a html
    document.<br>
    <br>
    <b>Properties</b><br>
    <br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">html__type</td>
          <td valign="top">string</td>
          <td valign="top">Contains the format of the current document.</td>
        </tr>
        <tr>
          <td valign="top">html</td>
          <td valign="top">table</td>
          <td valign="top">The top node of the html document object.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Methods</b><br>
    <ul id="mozToc">
      <!--mozToc h3 1-->
      <li><a href="#mozTocId112827">local html_node_to_text</a></li>
      <li><a href="#mozTocId359148">local fix_string_for_file</a></li>
      <li><a href="#mozTocId58148">htmlDoc:color</a></li>
      <li><a href="#mozTocId637390">htmlDoc:color_name</a></li>
      <li><a href="#mozTocId429442">htmlDoc:constructor</a></li>
      <li><a href="#mozTocId113314">htmlDoc:get_html</a></li>
      <li><a href="#mozTocId823824">htmlDoc:get_text</a></li>
      <li><a href="#mozTocId626437">htmlDoc:get_width</a></li>
      <li><a href="#mozTocId4021">htmlDoc:is_html</a></li>
      <li><a href="#mozTocId437670">htmlDoc:parse</a></li>
      <li><a href="#mozTocId737542">htmlDoc:parse_node</a></li>
      <li><a href="#mozTocId752616">htmlDoc:serialize</a></li>
      <li><a href="#mozTocId175704">htmlDoc:serialize_node</a></li>
      <li><a href="#mozTocId902761">htmlDoc:type</a></li>
    </ul>
    <br>
    See also <a moz-do-not-send="true" href="html_api.html">HTML API</a>,
    <a moz-do-not-send="true" href="api_reference.html">API Reference</a>,
    <a moz-do-not-send="true" href="index.html">WIN</a>.<br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId112827" class="mozTocH3"></a><a
        name="html_node_to_text"></a>local html_node_to_text</h3>
    <i> text html_node_to_text (node)</i><br>
    <br>
    Returns a plain text conversion of the html node's contents.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">node </td>
          <td valign="top">table </td>
          <td valign="top">The node to convert. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">text </td>
          <td valign="top">string </td>
          <td valign="top">The plain text conversion. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    This function is locally defined in the API, and is used by <a
      moz-do-not-send="true" href="#htmlDoc:get_text">htmlDoc:get_text</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId359148" class="mozTocH3"></a><a
        name="fix_string_for_file"></a>local fix_string_for_file</h3>
    <i>out_str </i><i>fix_string_for_file (in_str)</i><br>
    <br>
    Converts the input string to a form suitable for writing to a file
    as a string.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">in_str</td>
          <td valign="top">string<br>
          </td>
          <td valign="top">Input string to convert.<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">out_str</td>
          <td valign="top">string</td>
          <td valign="top">The converted string.<br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    This function is locally defined in the API, and is used by <a
      moz-do-not-send="true" href="#htmlDoc:serialize_node">htmlDoc:serialize_node</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId58148" class="mozTocH3"></a><a
        name="htmlDoc:color"></a>html.htmlDoc:color</h3>
    <i> color htmlDoc:color (source)</i><br>
    <br>
    Returns the color value of the html color source.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">source </td>
          <td valign="top">string/number </td>
          <td valign="top">May be either a <a moz-do-not-send="true"
              href="html_api.html#Colors">html color name or a color
              value</a>. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">color </td>
          <td valign="top">number </td>
          <td valign="top">The color value or nil if the source was not
            recognizable as a valid color. If a number it is a valid
            color value. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    This method can be used as a static member of the htmlDoc class.<br>
    <br>
    See <a moz-do-not-send="true" href="#htmlDoc:color_name">htmlDoc:color_name</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId637390" class="mozTocH3"></a><a
        name="htmlDoc:color_name"></a>html.htmlDoc:color_name</h3>
    <i> name htmlDoc:color_name (color)</i><br>
    <br>
    Returns the name of the html color source.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">source </td>
          <td valign="top">string/number </td>
          <td valign="top">May be either a html color name or a color
            value. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">name </td>
          <td valign="top">string </td>
          <td valign="top">The color value's html name or nil if the
            source was not recognizable as a valid color. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    This method can be used as a static member of the htmlDoc class.<br>
    <br>
    See <a moz-do-not-send="true" href="#htmlDoc:color">htmlDoc:color</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId429442" class="mozTocH3"></a><a
        name="htmlDoc:constructor"></a>html.htmlDoc:constructor</h3>
    <i> doc htmlDoc:constructor (source)</i><br>
    <br>
    Constructs and returns the instantiated html document object.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">source </td>
          <td valign="top">htmlDoc/string/nil </td>
          <td valign="top">If a htmlDoc object the document is copied.
            If a string it may be the raw html document (as loaded from
            a file) or plain text, which will be parsed. If nil the
            object is initialized with a blank document. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">doc </td>
          <td valign="top">htmlDoc </td>
          <td valign="top">The instantiated document object. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true" href="#htmlDoc:parse">htmlDoc:parse</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId113314" class="mozTocH3"></a><a
        name="htmlDoc:get_html"></a>html.htmlDoc:get_html</h3>
    <i> html htmlDoc:get_html ()</i><br>
    <br>
    Creates and returns the raw html string representation of the
    current document object.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">none </td>
          <td valign="top"><br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">html </td>
          <td valign="top">string </td>
          <td valign="top">The raw html representation of the document.
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    The returned string is suitable for saving to a file.<br>
    <br>
    See <a moz-do-not-send="true"
      href="browserWindow.html#browserWindow:get_html">browserWindow:get_html</a>,
    <a moz-do-not-send="true" href="#htmlDoc:serialize">htmlDoc:serialize</a>,
    <a moz-do-not-send="true" href="#htmlDoc:get_text">htmlDoc:get_text</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId823824" class="mozTocH3"></a><a
        name="htmlDoc:get_text"></a>html.htmlDoc:get_text</h3>
    <i> plain htmlDoc:get_text ()</i><br>
    <br>
    Creates and returns the plain text string representation of the
    current document object.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">none </td>
          <td valign="top"><br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">plain </td>
          <td valign="top">string </td>
          <td valign="top">The plain text representation of the
            document. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    The returned string is suitable for saving to a file.<br>
    <br>
    See <a moz-do-not-send="true"
      href="browserWindow.html#browserWindow:get_text">browserWindow:get_text</a>,
    <a moz-do-not-send="true" href="#htmlDoc:serialize">htmlDoc:serialize</a>,
    <a moz-do-not-send="true" href="#htmlDoc:get_html">htmlDoc:get_html</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId626437" class="mozTocH3"></a><a
        name="htmlDoc:get_width"></a>html.htmlDoc:get_width</h3>
    <i> width htmlDoc:get_width ()</i><br>
    <br>
    Returns the width value from the html document body tag if it has
    one, otherwise zero.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">none </td>
          <td valign="top"><br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">width </td>
          <td valign="top">number </td>
          <td valign="top">The document width value or zero. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true" href="htmlMap.html#htmlMap:get_width">htmlMap:get_width</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId4021" class="mozTocH3"></a><a
        name="htmlDoc:is_html"></a>html.htmlDoc:is_html</h3>
    <i> doc htmlDoc:is_html (doc)</i><br>
    <br>
    Returns the html document node object interpreted from the source.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">source </td>
          <td valign="top">htmlDoc/string </td>
          <td valign="top">The source to interpret. If a htmlDoc object
            it is returned. If a raw string html document, a new
            document node is created and returned. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">doc </td>
          <td valign="top">table/nil </td>
          <td valign="top">The document node. If source is not a valid
            html source nil is returned. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId437670" class="mozTocH3"></a><a
        name="htmlDoc:parse"></a>html.htmlDoc:parse</h3>
    <i> htmlDoc:parse (source)</i><br>
    <br>
    Parses the source as the current document object.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">source </td>
          <td valign="top">htmlDoc/string/nil </td>
          <td valign="top">If a htmlDoc object the document is copied.
            If a string it may be the raw html document (as loaded from
            a file) or plain text. If nil the document object is a blank
            document. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">none </td>
          <td valign="top"><br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true"
      href="browserWindow.html#browserWindow:set_text">browserWindow:set_text</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId737542" class="mozTocH3"></a><a
        name="htmlDoc:parse_node"></a>html.htmlDoc:parse_node</h3>
    <i> node htmlDoc:parse_node (node, def_tag)</i><br>
    <br>
    Parses the source node, returning a validated copy.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">source </td>
          <td valign="top">table/string </td>
          <td valign="top">The source node to parse. </td>
        </tr>
        <tr>
          <td valign="top">def_tag </td>
          <td valign="top">string/nil </td>
          <td valign="top">The default tag for the parsed node if source
            is a table and has no tag key. If nil no default tagging is
            implemented. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">node </td>
          <td valign="top">table/string </td>
          <td valign="top">The parsed node. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId752616" class="mozTocH3"></a><a
        name="htmlDoc:serialize"></a>html.htmlDoc:serialize</h3>
    <i> raw htmlDoc:serialize ()</i><br>
    <br>
    Serializes the document object into a raw text string. If the
    document's type is "text" then the returned string is a plain text
    representation, otherwise html.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">none </td>
          <td valign="top"><br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">raw </td>
          <td valign="top">string </td>
          <td valign="top">The raw text representation of the document.
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    The returned string is suitable for saving to a file.<br>
    <br>
    See <a moz-do-not-send="true"
      href="browserWindow.html#browserWindow:serialize">browserWindow:serialize</a>,
    <a moz-do-not-send="true" href="#htmlDoc:get_html">htmlDoc:get_html</a>,
    <a moz-do-not-send="true" href="#htmlDoc:get_text">htmlDoc:get_text</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId175704" class="mozTocH3"></a><a
        name="htmlDoc:serialize_node"></a>html.htmlDoc:serialize_node</h3>
    <i> html htmlDoc:serialize_node (node, indent)</i><br>
    <br>
    Creates and returns the raw html string representation of the node.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">node </td>
          <td valign="top">table </td>
          <td valign="top">The node to serialize. </td>
        </tr>
        <tr>
          <td valign="top">indent </td>
          <td valign="top">string </td>
          <td valign="top">The indent string to use for the output
            string's lines. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">html </td>
          <td valign="top">string </td>
          <td valign="top">The raw html representation of the node. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true" href="#htmlDoc:get_html">htmlDoc:get_html</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId902761" class="mozTocH3"></a><a
        name="htmlDoc:type"></a>html.htmlDoc:type</h3>
    <i> format htmlDoc:type ()</i><br>
    <br>
    Returns the format that the current document was parsed from.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">none </td>
          <td valign="top"><br>
          </td>
          <td valign="top"><br>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">format </td>
          <td valign="top">string </td>
          <td valign="top">The format of the document; either <font
              color="#ffcc00">"text"</font> or <font color="#ffcc00">"html"</font>.
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    See <a moz-do-not-send="true"
      href="browserWindow.html#browserWindow:doc_type">browserWindow:doc_type</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="htmlDoc.html#top">top</a><br>
    <br>
    <br>
    See also <a moz-do-not-send="true" href="html_api.html">HTML API</a>,
    <a moz-do-not-send="true" href="api_reference.html">API Reference</a>,
    <a moz-do-not-send="true" href="index.html">WIN</a>.<br>
    <br>
    <br>
  </body>
</html>
