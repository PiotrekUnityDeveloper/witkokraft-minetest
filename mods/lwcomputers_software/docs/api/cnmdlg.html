<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Common Dialog API</title>
    <meta name="author" content="loosewheel">
    <style>a:link {text-decoration:none;}</style>
  </head>
  <body style="font-family: sans-serif;">
    <h1 style="background-color: rgb(128, 128, 255); padding: 8pt;"><a
        name="top"></a>Common Dialog API - WIN</h1>
    The Common Dialog API provides a series of common purpose <a
      moz-do-not-send="true" href="popupFrame.html">popupFrame</a>
    dialogs, used frequently in application writing, and are utilized in
    the win API itself.<br>
    <br>
    <b>Functions</b><br>
    <ul id="mozToc">
      <!--mozToc h3 1-->
      <li><a href="#mozTocId269919">cmndlg.color</a></li>
      <li><a href="#mozTocId540192">cmndlg.confirm</a></li>
      <li><a href="#mozTocId521563">cmndlg.file</a></li>
      <li><a href="#mozTocId581319">cmndlg.input</a></li>
      <li><a href="#mozTocId31070">cmndlg.open_file</a></li>
      <li><a href="#mozTocId184929">cmndlg.print</a></li>
      <li><a href="#mozTocId614415">cmndlg.save_file</a></li>
    </ul>
    <br>
    See also <a moz-do-not-send="true" href="api_reference.html">API
      Reference</a>, <a moz-do-not-send="true" href="index.html">WIN</a>.<br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId269919" class="mozTocH3"></a><a
        name="cmndlg.color"></a>cmndlg.color</h3>
    result cmndlg.color (owner_frame, init_color, bgcolor)<br>
    <br>
    Displays a dialog to select a color.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">owner_frame </td>
          <td valign="top"><a moz-do-not-send="true"
              href="parentFrame.html">parentFrame</a> </td>
          <td valign="top">The owner frame of the dialog. Must be the
            currently active frame in the application (<a
              moz-do-not-send="true" href="applicationFrame.html">applicationFrame</a>
            or <a moz-do-not-send="true" href="popupFrame.html">popupFrame</a>).
          </td>
        </tr>
        <tr>
          <td valign="top">init_color </td>
          <td valign="top">number/nil </td>
          <td valign="top">The initially selected color,
            term.colors.black if nil. </td>
        </tr>
        <tr>
          <td valign="top">bgcolor</td>
          <td valign="top">number/nil</td>
          <td valign="top">Background color of the dialog, the theme's
            popup_back color if nil.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">number/nil </td>
          <td valign="top">The color selected on Ok, otherwise nil. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    The following example gains a color from the user.
    <pre><font color="#000066">local</font> last_color = term.colors.black<br>
<font color="#000066">local</font> color = cmndlg.color (appFrame, last_color)
<font color="#000066">if</font> color <font color="#000066">then</font>
&nbsp;&nbsp; last_color = color
<font color="#000066">end</font></pre>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId540192" class="mozTocH3"></a><a
        name="cmndlg.confirm"></a>cmndlg.confirm</h3>
    result cmndlg.confirm (owner_frame, title, message, default_ok,
    bgcolor)<br>
    <br>
    Displays a message dialog with an Ok button.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">owner_frame </td>
          <td valign="top"><a moz-do-not-send="true"
              href="parentFrame.html">parentFrame</a> </td>
          <td valign="top">The owner frame of the dialog. Must be the
            currently active frame in the application (<a
              moz-do-not-send="true" href="applicationFrame.html">applicationFrame</a>
            or <a moz-do-not-send="true" href="popupFrame.html">popupFrame</a>).
          </td>
        </tr>
        <tr>
          <td valign="top">title </td>
          <td valign="top">string </td>
          <td valign="top">Text to display in title bar. </td>
        </tr>
        <tr>
          <td valign="top">message</td>
          <td valign="top">string</td>
          <td valign="top">The message to display to the user.</td>
        </tr>
        <tr>
          <td valign="top">default_ok</td>
          <td valign="top">boolean</td>
          <td valign="top">If true the Ok button initially has input
            focus, otherwise the close button.</td>
        </tr>
        <tr>
          <td valign="top">bgcolor</td>
          <td valign="top">number/nil</td>
          <td valign="top">Background color of the dialog, the theme's
            popup_back color if nil.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">boolean </td>
          <td valign="top">True if the user selects Ok, false otherwise.
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    The following example asks the user if they wish to continue, with
    the close button initially active:<br>
    <pre><font color="#000066">if</font> cmndlg.confirm (appFrame, <font color="#ffcc00">"Continue"</font>, <font color="#ffcc00">"Do you want to continue?"</font>) <font color="#000066">then</font>
&nbsp;&nbsp; <font color="#cc0000">-- do something</font>
<font color="#000066">end</font></pre>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId521563" class="mozTocH3"></a><a name="cmndlg.file"></a>cmndlg.file</h3>
    <i> result cmndlg.file (owner_frame, title, init_path,
      prompt_overwrite, not_hidden, hide_new_dir, validate, bgcolor)</i><br>
    <br>
    Displays a file chooser dialog.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">owner_frame </td>
          <td valign="top"><a moz-do-not-send="true"
              href="parentFrame.html">parentFrame</a> </td>
          <td valign="top">The owner frame of the dialog. Must be the
            currently active frame in the application (<a
              moz-do-not-send="true" href="applicationFrame.html">applicationFrame</a>
            or <a moz-do-not-send="true" href="popupFrame.html">popupFrame</a>).
          </td>
        </tr>
        <tr>
          <td valign="top">title </td>
          <td valign="top">string </td>
          <td valign="top">Text to display in title bar. </td>
        </tr>
        <tr>
          <td valign="top">init_path</td>
          <td valign="top">string</td>
          <td valign="top">The initial path for the file dialog. Root if
            nil.</td>
        </tr>
        <tr>
          <td valign="top">prompt_overwrite</td>
          <td valign="top">boolean</td>
          <td valign="top">If true an overwrite confirmation is sought
            if the file exists, otherwise no confirmation.</td>
        </tr>
        <tr>
          <td valign="top">not_hidden</td>
          <td valign="top">boolean</td>
          <td valign="top">If true hidden files and folders are not
            displayed in the file list, otherwise they are (names that
            start with a .).</td>
        </tr>
        <tr>
          <td valign="top">hide_new_dir</td>
          <td valign="top">boolean</td>
          <td valign="top">If true the button to create a new folder is
            hidden, otherwise visible.</td>
        </tr>
        <tr>
          <td valign="top">validate</td>
          <td valign="top">function/nil</td>
          <td valign="top"> A function that will be called to validate
            the file path. No validation if nil.</td>
        </tr>
        <tr>
          <td valign="top">bgcolor</td>
          <td valign="top">number/nil</td>
          <td valign="top">Background color of the dialog, the theme's
            popup_back color if nil.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">string/nil </td>
          <td valign="top">The selected full file path on Ok, otherwise
            nil. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    If a validation function is specified, if it returns false the
    dialog will remain active, and the file name field selected and
    placed into error state. Otherwise the dialog dismisses returning
    the full path. The validation function is of the form:<br>
    <br>
    <i>continue validate (path)</i><br>
    <br>
    See <a moz-do-not-send="true" href="#cmndlg.save_file">cmndlg.save_file</a>,
    <a moz-do-not-send="true" href="#cmndlg.open_file">cmndlg.open_file</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true" href="#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId581319" class="mozTocH3"></a><a
        name="cmndlg.input"></a>cmndlg.input</h3>
    <i> result cmndlg.input (owner_frame, title, prompt, init_text,
      banner, max_len, validate, bgcolor)</i><br>
    <br>
    Displays a single input field dialog with an Ok button.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">owner_frame </td>
          <td valign="top"><a moz-do-not-send="true"
              href="parentFrame.html">parentFrame</a> </td>
          <td valign="top">The owner frame of the dialog. Must be the
            currently active frame in the application (<a
              moz-do-not-send="true" href="applicationFrame.html">applicationFrame</a>
            or <a moz-do-not-send="true" href="popupFrame.html">popupFrame</a>).
          </td>
        </tr>
        <tr>
          <td valign="top">title</td>
          <td valign="top">string</td>
          <td valign="top">Text to display in title bar.</td>
        </tr>
        <tr>
          <td valign="top">prompt </td>
          <td valign="top">string </td>
          <td valign="top">Text to display in the prompt label. </td>
        </tr>
        <tr>
          <td valign="top">init_text</td>
          <td valign="top">string/nil</td>
          <td valign="top">Initial text in the input field, empty if
            nil.</td>
        </tr>
        <tr>
          <td valign="top">banner</td>
          <td valign="top">string/nil</td>
          <td valign="top">Banner text for the input field, none if nil.</td>
        </tr>
        <tr>
          <td valign="top">max_len</td>
          <td valign="top">number/nil</td>
          <td valign="top">Maximum character length that may be entered
            by the user, unlimited if nil.</td>
        </tr>
        <tr>
          <td valign="top">validate</td>
          <td valign="top">function/nil</td>
          <td valign="top">A function that will be called to validate
            the user input. No validation if nil.</td>
        </tr>
        <tr>
          <td valign="top">bgcolor</td>
          <td valign="top">number/nil</td>
          <td valign="top">Background color of the dialog, the theme's
            popup_back color if nil.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">string/nil </td>
          <td valign="top">The user input if Ok, otherwise nil. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    If a validation function is specified, if it returns false the
    dialog will remain active, and the input field selected and placed
    into error state. Otherwise the dialog dismisses returning the
    input. The validation function is of the form:<br>
    <br>
    <i>
      continue validate (user_input)</i><br>
    <br>
    The following example gains user input for a file name. The
    validation ensures the entered is not empty and does not contain a <font
      color="#ffcc00">"/"</font> character.<br>
    <pre><font color="#000066">local</font> <font color="#000066">function</font> validate (str)
&nbsp;&nbsp; <font color="#000066">return</font> (<font color="#000066">string.len</font> (str) &gt; <font color="#339999">0</font> <font color="#000066">and</font> <font color="#000066">string.find</font> (str, <font color="#ffcc00">"/"</font>, 1) == <font color="#000066">nil</font>)
end<br><br><font color="#000066">local</font> name = cmndlg.input (appFrame, <font color="#ffcc00">"New File"</font>, <font color="#ffcc00">"Enter the new file name"</font>, <font color="#000066">nil</font>, <font color="#000066">nil</font>, <font color="#000066">nil</font>, validate)
<font color="#000066">if</font> name <font color="#000066">then</font>
&nbsp;&nbsp; appFrame:msgbox (<font color="#ffcc00">"You entered"</font>, name)
<font color="#000066">end</font></pre>
    <br>
    <a moz-do-not-send="true"
href="cnmdlg.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId31070" class="mozTocH3"></a><a
        name="cmndlg.open_file"></a>cmndlg.open_file</h3>
    <i> result cmndlg.open_file (owner_frame, init_path, not_hidden,
      validate, bgcolor)</i><br>
    <br>
    Wraps <a moz-do-not-send="true" href="#cmndlg.file">cmndlg.file</a>
    with suitable parameters for an open file operation, and provides
    initial validation that the selected file exists.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">owner_frame </td>
          <td valign="top"><a moz-do-not-send="true"
              href="parentFrame.html">parentFrame</a> </td>
          <td valign="top">The owner frame of the dialog. Must be the
            currently active frame in the application (<a
              moz-do-not-send="true" href="applicationFrame.html">applicationFrame</a>
            or <a moz-do-not-send="true" href="popupFrame.html">popupFrame</a>).
          </td>
        </tr>
        <tr>
          <td valign="top">init_path </td>
          <td valign="top">string</td>
          <td valign="top">The initial path for the file dialog. Root if
            nil.</td>
        </tr>
        <tr>
          <td valign="top">not_hidden</td>
          <td valign="top">boolean</td>
          <td valign="top">If true hidden files and folders are not
            displayed in the file list, otherwise they are (names that
            start with a .). </td>
        </tr>
        <tr>
          <td valign="top">validate</td>
          <td valign="top">function/nil</td>
          <td valign="top">A function that will be called to validate
            the file path. No validation if nil.</td>
        </tr>
        <tr>
          <td valign="top">bgcolor</td>
          <td valign="top">number/nil</td>
          <td valign="top">Background color of the dialog, the theme's
            popup_back color if nil.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">string </td>
          <td valign="top">The selected full file path on Ok, otherwise
            nil. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    If a validation function is specified, if it returns false the
    dialog will remain active, and the file name field selected and
    placed into error state. Otherwise the dialog dismisses returning
    the full path. The validation function is of the form:<br>
    <br>
    <i>
      continue validate (path)</i><br>
    <br>
    The following example gains a file path from the user.<br>
    <pre><font color="#000066">local</font> last_path<br>
<font color="#000066">local</font> path = cmndlg.open_file (appFrame, last_path)
<font color="#000066">if</font> path <font color="#000066">then</font>
&nbsp;&nbsp; last_path = path
<font color="#000066">end</font></pre>
    See <a moz-do-not-send="true" href="#cmndlg.save_file">cmndlg.save_file</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true"
href="cnmdlg.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId184929" class="mozTocH3"></a><a
        name="cmndlg.print"></a>cmndlg.print</h3>
    <i> printer, from_page, to_page cmndlg.print (owner_frame,
      total_pages, bgcolor)</i><br>
    <br>
    Displays a dialog to select an available printer, and optionally
    enter a page range.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">owner_frame </td>
          <td valign="top"><a moz-do-not-send="true"
              href="parentFrame.html">parentFrame</a> </td>
          <td valign="top">The owner frame of the dialog. Must be the
            currently active frame in the application (<a
              moz-do-not-send="true" href="applicationFrame.html">applicationFrame</a>
            or <a moz-do-not-send="true" href="popupFrame.html">popupFrame</a>).
          </td>
        </tr>
        <tr>
          <td valign="top">total_pages </td>
          <td valign="top">number/nil </td>
          <td valign="top">The total pages available to print. If nil
            the page range controls are not displayed. </td>
        </tr>
        <tr>
          <td valign="top">bgcolor</td>
          <td valign="top">number/nil</td>
          <td valign="top">Background color of the dialog, the theme's
            popup_back color if nil.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">printer </td>
          <td valign="top">string/nil </td>
          <td valign="top">The selected printer's digilines channel on
            Ok, otherwise nil. </td>
        </tr>
        <tr>
          <td valign="top">from_page </td>
          <td valign="top">number/nil </td>
          <td valign="top">On Ok, if total_pages was specified then the
            first page to print. If total_pages was not specified then
            zero. On close is always nil. </td>
        </tr>
        <tr>
          <td valign="top">to_page</td>
          <td valign="top">number/nil</td>
          <td valign="top">On Ok, if total_pages was specified then the
            last page to print. If total_pages was not specified then
            zero. On close is always nil.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    The following example gains a printer from the user.<br>
    <pre><font color="#000066">local</font> printer = cmndlg.print (appFrame)
<font color="#000066">if</font> printer <font color="#000066">then</font>
&nbsp;&nbsp; appFrame:msgbox (<font color="#ffcc00">"You Selected"</font>, printer)
<font color="#000066">end</font></pre>
    <br>
    <a moz-do-not-send="true"
href="cnmdlg.html#top">top</a><br>
    <br>
    <br>
    <h3 style="background-color: rgb(192, 192, 255); padding: 8pt;"><a
        name="mozTocId614415" class="mozTocH3"></a><a
        name="cmndlg.save_file"></a>cmndlg.save_file</h3>
    <i> result cmndlg.save_file (owner_frame, init_path, not_hidden,
      validate, bgcolor)</i><br>
    <br>
    Wraps <a moz-do-not-send="true" href="#cmndlg.file">cmndlg.file</a>
    with suitable parameters for a save file operation.<br>
    <br>
    <b>Parameters</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">owner_frame </td>
          <td valign="top"><a moz-do-not-send="true"
              href="parentFrame.html">parentFrame</a> </td>
          <td valign="top">The owner frame of the dialog. Must be the
            currently active frame in the application (<a
              moz-do-not-send="true" href="applicationFrame.html">applicationFrame</a>
            or <a moz-do-not-send="true" href="popupFrame.html">popupFrame</a>).
          </td>
        </tr>
        <tr>
          <td valign="top">init_path </td>
          <td valign="top">string </td>
          <td valign="top">The initial path for the file dialog. Root if
            nil. </td>
        </tr>
        <tr>
          <td valign="top">not_hidden</td>
          <td valign="top">boolean</td>
          <td valign="top">If true hidden files and folders are not
            displayed in the file list, otherwise they are.</td>
        </tr>
        <tr>
          <td valign="top">validate</td>
          <td valign="top">function/nil</td>
          <td valign="top">A function that will be called to validate
            the file path. No validation if nil.</td>
        </tr>
        <tr>
          <td valign="top">bgcolor</td>
          <td valign="top">number/nil</td>
          <td valign="top">Background color of the dialog, the theme's
            popup_back color if nil.</td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Returns</b><br>
    <table width="100%" cellspacing="0" cellpadding="2" border="0">
      <tbody>
        <tr>
          <td valign="top">result </td>
          <td valign="top">string </td>
          <td valign="top">The selected full file path on Ok, otherwise
            nil. </td>
        </tr>
      </tbody>
    </table>
    <br>
    <b>Remarks</b><br>
    If a validation function is specified, if it returns false the
    dialog will remain active, and the file name field selected and
    placed into error state. Otherwise the dialog dismisses returning
    the full path. The validation function is of the form:<br>
    <br>
    <i>
      continue validate (path)</i><br>
    <br>
    The following example gains the file path from the user.<br>
    <pre><font color="#000066">local</font> last_path;<br>
<font color="#000066">local</font> path = cmndlg.save_file (appFrame, last_path)
<font color="#000066">if</font> path <font color="#000066">then</font>
&nbsp;&nbsp; last_path = path
<font color="#000066">end</font></pre>
    <br>
    See <a moz-do-not-send="true" href="#cmndlg.open_file">cmndlg.open_file</a>.<br>
    <br>
    <br>
    <a moz-do-not-send="true"
href="cnmdlg.html#top">top</a><br>
    <br>
    <br>
    See also <a moz-do-not-send="true" href="api_reference.html">API
      Reference</a>, <a moz-do-not-send="true" href="index.html">WIN</a>.<br>
    <br>
    <br>
  </body>
</html>
